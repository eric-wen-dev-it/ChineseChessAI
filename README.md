# ChineseChessAI-Zero

A high-performance C# implementation of a Chinese Chess (Xiangqi) AI, based on the **AlphaZero** (CCZero) methodology. This project features a deep residual neural network integrated with Monte Carlo Tree Search (MCTS), optimized for modern NVIDIA hardware.

> **Development Note**: This project was architected and implemented by **Gemini** (Google's AI) under the iterative guidance, technical constraints, and domain expertise of the lead developer.

## 🚀 Key Features

* **AlphaZero Framework**: A self-play reinforcement learning pipeline (Self-Play -> Replay Buffer -> Training).
* **Neural Network**: Residual Network (ResNet) architecture with dual heads (Policy and Value), implemented via **TorchSharp**.
* **MCTS Engine**:
* Asynchronous Batch Inference to maximize GPU utilization.
* Support for **3200+ simulations** per move.
* Advanced PUCT (Predictor Upper Confidence Bound applied to Trees) algorithm.


* **Xiangqi Domain Logic**:
* High-speed legal move generation with `IsKingSafe` and "Flying General" (King-to-King) detection.
* Hardcoded **Threefold Repetition** detection and penalty logic.


* **Training Optimizations**:
* Penalty-based draw avoidance (incentivizing aggressive play).
* Support for Large Batch Sizes (4096) and multi-epoch training.



## 🛠️ Tech Stack

* **Language**: C# / .NET 10
* **UI Framework**: WPF (Windows Presentation Foundation)
* **Deep Learning**: [TorchSharp]() (LibTorch 2.x bindings)
* **Hardware Acceleration**: NVIDIA CUDA (Optimized for **RTX 2000 Ada**)

## 📈 Current Status (Iteration 91+)

The model has transitioned from a defensive posture to an aggressive tactical phase:

* **Loss Stability**: Current Loss resides around **1.5 - 1.9**, stabilizing after a major logic update regarding draw penalties.
* **Tactical Depth**: Demonstrates strong defense (up to 1000 moves) and emerging "Kill" instinct (checkmates observed within 70 moves in mid-game).
* **Performance**: Achieving ~49% GPU utilization on RTX 2000 Ada with 3200 MCTS simulations.

## 📋 Configuration & Usage

### Prerequisites

* Windows 10/11
* NVIDIA GPU with **CUDA Toolkit 12.x** installed.
* .NET 10 SDK

### Running the Pipeline

1. **Self-Play**: Launch the application to start generating self-play games. Samples are automatically stored in the `ReplayBuffer`.
2. **Training**: The `Trainer` module will periodically pull samples and perform gradient descent to update the `best_model.pt`.
3. **Inference**: Use the `MCTSEngine` to play against the AI or analyze specific board positions.

## 🤝 Acknowledgments

This project is a testament to AI-Human collaboration. The core engine, state encoding, and MCTS optimizations were generated by **Gemini**, while the strategic direction, troubleshooting of customs/shipping logistics for hardware, and domain-specific rules were provided by the user.
