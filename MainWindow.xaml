<Window x:Class="ChineseChessAI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="ChineseChess AlphaZero Trainer" Height="700" Width="1000">
    <Window.Resources>
        <Style x:Key="ChessPieceStyle" TargetType="Button">
            <Setter Property="Background" Value="#F5F5DC"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Grid>
                            <Ellipse x:Name="OuterCircle" 
                                     Fill="{TemplateBinding Background}" 
                                     Stroke="#5D4037" 
                                     StrokeThickness="2">
                                <Ellipse.Effect>
                                    <DropShadowEffect BlurRadius="2" Color="Black" Opacity="0.3" ShadowDepth="1"/>
                                </Ellipse.Effect>
                            </Ellipse>

                            <Ellipse x:Name="InnerCircle" Margin="3" 
                                     Stroke="{TemplateBinding Foreground}" 
                                     StrokeThickness="1" Opacity="0.3"/>

                            <Rectangle x:Name="HighlightBox" 
                                       StrokeThickness="3" 
                                       Visibility="Collapsed"
                                       Margin="-2"/>

                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Grid>

                        <ControlTemplate.Triggers>
                            <Trigger Property="Content" Value="">
                                <Setter TargetName="OuterCircle" Property="Visibility" Value="Collapsed"/>
                                <Setter TargetName="InnerCircle" Property="Visibility" Value="Collapsed"/>
                            </Trigger>

                            <Trigger Property="Tag" Value="From">
                                <Setter TargetName="HighlightBox" Property="Visibility" Value="Visible"/>
                                <Setter TargetName="HighlightBox" Property="Stroke" Value="#FF4500"/>
                            </Trigger>
                            <Trigger Property="Tag" Value="To">
                                <Setter TargetName="HighlightBox" Property="Visibility" Value="Visible"/>
                                <Setter TargetName="HighlightBox" Property="Stroke" Value="#00FF7F"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid Background="#333333">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="650"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <Grid Grid.Column="0" Margin="20">
            <Border Background="#D2B48C" BorderBrush="#5D4037" BorderThickness="4" CornerRadius="2">
                <Grid Margin="10">
                    <Canvas x:Name="ChessLinesCanvas" IsHitTestVisible="False" />
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Center" IsHitTestVisible="False">
                        <TextBlock Text="楚 河" FontSize="32" FontWeight="Bold" Foreground="#5D4037" Margin="0,0,120,0" Opacity="0.4"/>
                        <TextBlock Text="汉 界" FontSize="32" FontWeight="Bold" Foreground="#5D4037" Opacity="0.4"/>
                    </StackPanel>
                    <UniformGrid x:Name="ChessBoardGrid" Rows="10" Columns="9" Background="Transparent"/>
                </Grid>
            </Border>
        </Grid>

        <StackPanel Grid.Column="1" Margin="10,20,20,20">
            <Button x:Name="StartBtn" Content="开始进化" Height="45" FontSize="16" FontWeight="Bold"
                    Click="OnStartTrainingClick" Margin="0,0,0,10" Background="#4CAF50" Foreground="White"/>

            <UniformGrid Columns="2" Margin="0,0,0,15">
                <Button x:Name="ReplayLastBtn" Content="观看最新一局" Height="35" FontSize="14" FontWeight="Bold"
                        Click="OnReplayLastClick" Background="#2196F3" Foreground="White" Margin="0,0,5,0"
                        ToolTip="从后台训练队列中提取最新的一局完整对战进行演示"/>
                <Button x:Name="LoadFileBtn" Content="打开棋谱文件" Height="35" FontSize="14" FontWeight="Bold"
                        Click="OnLoadFileClick" Background="#FF9800" Foreground="White" Margin="5,0,0,0"
                        ToolTip="选择本地的 game_xxx.txt 棋谱文件并进行演示"/>
            </UniformGrid>

            <TextBlock Text="平均 Loss:" Foreground="White" FontSize="14" Margin="0,0,0,5"/>
            <TextBlock x:Name="LossLabel" Text="0.0000" Foreground="Yellow" FontSize="18" FontWeight="Bold" Margin="0,0,0,10"/>
            <TextBlock Text="训练日志:" Foreground="White" Margin="0,0,0,5"/>
            <TextBox x:Name="LogBox" Height="250" VerticalScrollBarVisibility="Auto" IsReadOnly="True" 
                     Background="Black" Foreground="Lime" FontFamily="Consolas" FontSize="11" Margin="0,0,0,10" TextWrapping="Wrap"/>
            <TextBlock Text="标准化 UCCI 棋谱:" Foreground="White" Margin="0,0,0,5"/>
            <TextBox x:Name="MoveListLog" Height="100" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto" 
                     IsReadOnly="True" Background="#222" Foreground="White" Padding="5" FontSize="11"/>
        </StackPanel>
    </Grid>
</Window>